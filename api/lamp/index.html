<!DOCTYPE html ><html><head><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" name="viewport"/><title></title><meta content="" name="description"/><meta content="" name="keywords"/><meta http-equiv="content-type" content="text/html; charset=UTF-8"/><link href="../lib/index.css" media="screen" type="text/css" rel="stylesheet"/><link href="../lib/template.css" media="screen" type="text/css" rel="stylesheet"/><link href="../lib/print.css" media="print" type="text/css" rel="stylesheet"/><link href="../lib/diagrams.css" media="screen" type="text/css" rel="stylesheet" id="diagrams-css"/><script type="text/javascript" src="../lib/jquery.min.js"></script><script type="text/javascript" src="../lib/index.js"></script><script type="text/javascript" src="../index.js"></script><script type="text/javascript" src="../lib/scheduler.js"></script><script type="text/javascript" src="../lib/template.js"></script><script type="text/javascript">/* this variable can be used by the JS to determine the path to the root document */
var toRoot = '../';</script></head><body><div id="search"><span id="doc-title"><span id="doc-version"></span></span> <span class="close-results"><span class="left">&lt;</span> Back</span><div id="textfilter"><span class="input"><input autocapitalize="none" placeholder="Search" id="index-input" type="text" accesskey="/"/><i class="clear material-icons"></i><i id="search-icon" class="material-icons"></i></span></div></div><div id="search-results"><div id="search-progress"><div id="progress-fill"></div></div><div id="results-content"><div id="entity-results"></div><div id="member-results"></div></div></div><div id="content-scroll-container" style="-webkit-overflow-scrolling: touch;"><div id="content-container" style="-webkit-overflow-scrolling: touch;"><div id="subpackage-spacer"><div id="packages"><h1>Packages</h1><ul><li class="indented0 " name="_root_.root" group="Ungrouped" fullComment="yes" data-isabs="false" visbl="pub"><a id="_root_" class="anchorToMember"></a><a id="root:_root_" class="anchorToMember"></a> <span class="permalink"><a href="../index.html" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">package</span></span> <span class="symbol"><a href="../index.html" title=""><span class="name">root</span></a></span><div class="fullcomment"><dl class="attributes block"><dt>Definition Classes</dt><dd><a href="../index.html" name="_root_" id="_root_" class="extype">root</a></dd></dl></div></li><li class="indented1 current" name="_root_.lamp" group="Ungrouped" fullComment="yes" data-isabs="false" visbl="pub"><a id="lamp" class="anchorToMember"></a><a id="lamp:lamp" class="anchorToMember"></a> <span class="permalink"><a href="../lamp/index.html" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">package</span></span> <span class="symbol"><span class="name">lamp</span></span><p class="shortcomment cmt">Lamp provides utilities to build state of the art machine learning
applications</p><div class="fullcomment"><div class="comment cmt"><p>Lamp provides utilities to build state of the art machine learning
applications</p><h3>Overview</h3><p>Notable types and packages:</p><ul><li><a href="STen.html" name="lamp.STen" id="lamp.STen" class="extype">lamp.STen</a> is a memory managed wrapper around aten.ATen, an off the
    heap, native n-dimensionl array backed by libtorch.</li><li><a href="autograd/index.html" name="lamp.autograd" id="lamp.autograd" class="extype">lamp.autograd</a> implements reverse mode automatic differentiation.</li><li><a href="nn/index.html" name="lamp.nn" id="lamp.nn" class="extype">lamp.nn</a> contains neural network building blocks, see e.g.
    <a href="nn/Linear.html" name="lamp.nn.Linear" id="lamp.nn.Linear" class="extype">lamp.nn.Linear</a>.</li><li><a href="data/IOLoops$.html" name="lamp.data.IOLoops" id="lamp.data.IOLoops" class="extype">lamp.data.IOLoops</a> implements a training loop and other data related
    abstractions.</li><li><a href="knn/index.html" name="lamp.knn" id="lamp.knn" class="extype">lamp.knn</a> implements k-nearest neighbor search on the CPU and GPU</li><li><a href="umap/Umap$.html" name="lamp.umap.Umap" id="lamp.umap.Umap" class="extype">lamp.umap.Umap</a> implements the UMAP dimension reduction algorithm</li><li><a href="onnx/index.html" name="lamp.onnx" id="lamp.onnx" class="extype">lamp.onnx</a> implements serialization of computation graphs into ONNX
    format</li><li>lamp.io contains CSV and NPY readers</li></ul><h5>How to get data into lamp</h5><p>Use one of the file readers in lamp.io or one of the factories in
<a href="STen$.html" name="lamp.STen" id="lamp.STen" class="extype">lamp.STen$</a>.</p><h5>How to define a custom neural network layer</h5><p>See the documentation on <a href="nn/GenericModule.html" name="lamp.nn.GenericModule" id="lamp.nn.GenericModule" class="extype">lamp.nn.GenericModule</a></p><h5>How to compose neural network layers</h5><p>See the documentation on <a href="nn/index.html" name="lamp.nn" id="lamp.nn" class="extype">lamp.nn</a></p><h5>How to train models</h5><p>See the training loops in <a href="data/IOLoops$.html" name="lamp.data.IOLoops" id="lamp.data.IOLoops" class="extype">lamp.data.IOLoops</a>
</p></div><dl class="attributes block"><dt>Definition Classes</dt><dd><a href="../index.html" name="_root_" id="_root_" class="extype">root</a></dd></dl></div></li><li class="indented2 " name="lamp.autograd" group="Ungrouped" fullComment="yes" data-isabs="false" visbl="pub"><a id="autograd" class="anchorToMember"></a><a id="autograd:autograd" class="anchorToMember"></a> <span class="permalink"><a href="../lamp/autograd/index.html" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">package</span></span> <span class="symbol"><a href="autograd/index.html" title="Implements reverse mode automatic differentiaton"><span class="name">autograd</span></a></span><p class="shortcomment cmt">Implements reverse mode automatic differentiaton</p><div class="fullcomment"><div class="comment cmt"><p>Implements reverse mode automatic differentiaton</p><p>The main types in this package are <a href="autograd/Variable.html" name="lamp.autograd.Variable" id="lamp.autograd.Variable" class="extype">lamp.autograd.Variable</a> and
<a href="autograd/Op.html" name="lamp.autograd.Op" id="lamp.autograd.Op" class="extype">lamp.autograd.Op</a>. The computational graph built by this package consists
of vertices representing values (as <a href="autograd/Variable.html" name="lamp.autograd.Variable" id="lamp.autograd.Variable" class="extype">lamp.autograd.Variable</a>) and vertices
representing operations (as <a href="autograd/Op.html" name="lamp.autograd.Op" id="lamp.autograd.Op" class="extype">lamp.autograd.Op</a>).</p><p>Variables contain the value of a <code>R<sup>n</sup> =&gt; R<sup>m</sup></code> function. Variables may also
contain the partial derivative of their argument with respect to a single
scalar. A Variable whose value is a scalar (m=1) can trigger the computation
of partial derivatives of all the intermediate upstream Variables. Computing
partial derivatives with respect to non-scalar variables is not supported.</p><p>A constant Variable may be created with the <code>const</code> or <code>param</code> factory
method in this package. <code>const</code> may be used for constants which do not need
their partial derivatives to be computed. <code>param</code> on the other hand create
Variables which will fill in their partial derivatives. Further variables
may be created by the methods in this class, eventually expressing more
complex <code>R<sup>n</sup> =&gt; R<sup>m</sup></code> functions.</p><h5>Example</h5><pre>lamp.Scope.root{ <span class="kw">implicit</span> scope <span class="kw">=&gt;</span>
  <span class="cmt">// x is constant (depends on no other variables) and won't compute a partial derivative</span>
  <span class="kw">val</span> x = lamp.autograd.const(STen.eye(<span class="num">3</span>, STenOptions.d))
  <span class="cmt">// y is constant but will compute a partial derivative</span>
  <span class="kw">val</span> y = lamp.autograd.param(STen.ones(<span class="std">List</span>(<span class="num">3</span>,<span class="num">3</span>), STenOptions.d))

  <span class="cmt">// z is a Variable with x and y dependencies</span>
  <span class="kw">val</span> z = x+y

  <span class="cmt">// w is a Variable with z as a direct and x, y as transient dependencies</span>
  <span class="kw">val</span> w = z.sum
  <span class="cmt">// w is a scalar (number of elements is 1), thus we can call backprop() on it.</span>
  <span class="cmt">// calling backprop will fill out the partial derivatives of the upstream variables</span>
  w.backprop()

  <span class="cmt">// partialDerivative is empty since we created `x` with `const`</span>
  assert(x.partialDerivative.isEmpty)

  <span class="cmt">// `y`'s partial derivatie is defined and is computed</span>
  <span class="cmt">// it holds `y`'s partial derivative with respect to `w`, the scalar which we called backprop() on</span>
  assert(y.partialDerivative.isDefined)

}</pre><p>This package may be used to compute the derivative of any function, provided
the function can be composed out of the provided methods. A particular use
case is gradient based optimization.
</p></div><dl class="attributes block"><dt>See also</dt><dd><span class="cmt"><p>
  <a href="https://arxiv.org/pdf/1811.05031.pdf" target="_blank">https://arxiv.org/pdf/1811.05031.pdf</a> for a review of the algorithm</p></span><span class="cmt"><p>
  <a href="autograd/Op.html" name="lamp.autograd.Op" id="lamp.autograd.Op" class="extype">lamp.autograd.Op</a> for how to implement a new operation</p></span></dd></dl></div></li><li class="indented2 " name="lamp.data" group="Ungrouped" fullComment="no" data-isabs="false" visbl="pub"><a id="data" class="anchorToMember"></a><a id="data:data" class="anchorToMember"></a> <span class="permalink"><a href="../lamp/data/index.html" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">package</span></span> <span class="symbol"><a href="data/index.html" title=""><span class="name">data</span></a></span></li><li class="indented2 " name="lamp.distributed" group="Ungrouped" fullComment="no" data-isabs="false" visbl="pub"><a id="distributed" class="anchorToMember"></a><a id="distributed:distributed" class="anchorToMember"></a> <span class="permalink"><a href="../lamp/distributed/index.html" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">package</span></span> <span class="symbol"><a href="distributed/index.html" title=""><span class="name">distributed</span></a></span></li><li class="indented2 " name="lamp.extratrees" group="Ungrouped" fullComment="no" data-isabs="false" visbl="pub"><a id="extratrees" class="anchorToMember"></a><a id="extratrees:extratrees" class="anchorToMember"></a> <span class="permalink"><a href="../lamp/extratrees/index.html" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">package</span></span> <span class="symbol"><a href="extratrees/index.html" title=""><span class="name">extratrees</span></a></span></li><li class="indented2 " name="lamp.knn" group="Ungrouped" fullComment="no" data-isabs="false" visbl="pub"><a id="knn" class="anchorToMember"></a><a id="knn:knn" class="anchorToMember"></a> <span class="permalink"><a href="../lamp/knn/index.html" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">package</span></span> <span class="symbol"><a href="knn/index.html" title=""><span class="name">knn</span></a></span></li><li class="indented2 " name="lamp.nn" group="Ungrouped" fullComment="yes" data-isabs="false" visbl="pub"><a id="nn" class="anchorToMember"></a><a id="nn:nn" class="anchorToMember"></a> <span class="permalink"><a href="../lamp/nn/index.html" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">package</span></span> <span class="symbol"><a href="nn/index.html" title="Provides building blocks for neural networks"><span class="name">nn</span></a></span><p class="shortcomment cmt">Provides building blocks for neural networks</p><div class="fullcomment"><div class="comment cmt"><p>Provides building blocks for neural networks</p><p>Notable types:</p><ul><li><a href="nn/GenericModule.html" name="lamp.nn.GenericModule" id="lamp.nn.GenericModule" class="extype">nn.GenericModule</a> is an abstraction on parametric functions</li><li><a href="nn/Optimizer.html" name="lamp.nn.Optimizer" id="lamp.nn.Optimizer" class="extype">nn.Optimizer</a> is an abstraction of gradient based optimizers</li><li><a href="nn/LossFunction.html" name="lamp.nn.LossFunction" id="lamp.nn.LossFunction" class="extype">nn.LossFunction</a> is an abstraction of loss functions, see the
    companion object for the implemented losses</li><li><a href="nn/SupervisedModel.html" name="lamp.nn.SupervisedModel" id="lamp.nn.SupervisedModel" class="extype">nn.SupervisedModel</a> combines a module with a loss</li></ul><p>Optimizers:</p><ul><li><a href="nn/AdamW.html" name="lamp.nn.AdamW" id="lamp.nn.AdamW" class="extype">nn.AdamW</a></li><li><a href="nn/SGDW.html" name="lamp.nn.SGDW" id="lamp.nn.SGDW" class="extype">nn.SGDW</a></li><li><a href="nn/RAdam.html" name="lamp.nn.RAdam" id="lamp.nn.RAdam" class="extype">nn.RAdam</a></li><li><a href="nn/Yogi.html" name="lamp.nn.Yogi" id="lamp.nn.Yogi" class="extype">nn.Yogi</a></li></ul><p>Modules facilitating composing other modules:</p><ul><li><a href="nn/Sequential.html" name="lamp.nn.Sequential" id="lamp.nn.Sequential" class="extype">nn.Sequential</a> composes a homogenous list of modules (analogous to
    List)</li><li><a href="nn/sequence$.html" name="lamp.nn.sequence" id="lamp.nn.sequence" class="extype">nn.sequence</a> composes a heterogeneous list of modules (analogous to
    tuples)</li><li><a href="nn/EitherModule.html" name="lamp.nn.EitherModule" id="lamp.nn.EitherModule" class="extype">nn.EitherModule</a> composes two modules in a scala.Either</li></ul><p>Examples of neural network building blocks, layers etc:</p><ul><li><a href="nn/Linear.html" name="lamp.nn.Linear" id="lamp.nn.Linear" class="extype">nn.Linear</a> implements <code>W X + b</code> with parameters <code>W</code> and <code>b</code> and input
    <code>X</code></li><li><a href="nn/BatchNorm.html" name="lamp.nn.BatchNorm" id="lamp.nn.BatchNorm" class="extype">nn.BatchNorm</a>, <a href="nn/LayerNorm.html" name="lamp.nn.LayerNorm" id="lamp.nn.LayerNorm" class="extype">nn.LayerNorm</a> implement batch and layer
    normalization</li><li><a href="nn/MLP$.html" name="lamp.nn.MLP" id="lamp.nn.MLP" class="extype">nn.MLP</a> is a factory of a multilayer perceptron architecture
</li></ul></div></div></li><li class="indented2 " name="lamp.onnx" group="Ungrouped" fullComment="no" data-isabs="false" visbl="pub"><a id="onnx" class="anchorToMember"></a><a id="onnx:onnx" class="anchorToMember"></a> <span class="permalink"><a href="../lamp/onnx/index.html" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">package</span></span> <span class="symbol"><a href="onnx/index.html" title=""><span class="name">onnx</span></a></span></li><li class="indented2 " name="lamp.saddle" group="Ungrouped" fullComment="no" data-isabs="false" visbl="pub"><a id="saddle" class="anchorToMember"></a><a id="saddle:saddle" class="anchorToMember"></a> <span class="permalink"><a href="../lamp/saddle/index.html" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">package</span></span> <span class="symbol"><a href="saddle/index.html" title=""><span class="name">saddle</span></a></span></li><li class="indented2 " name="lamp.umap" group="Ungrouped" fullComment="no" data-isabs="false" visbl="pub"><a id="umap" class="anchorToMember"></a><a id="umap:umap" class="anchorToMember"></a> <span class="permalink"><a href="../lamp/umap/index.html" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">package</span></span> <span class="symbol"><a href="umap/index.html" title=""><span class="name">umap</span></a></span></li><li class="indented2 " name="lamp.util" group="Ungrouped" fullComment="no" data-isabs="false" visbl="pub"><a id="util" class="anchorToMember"></a><a id="util:util" class="anchorToMember"></a> <span class="permalink"><a href="../lamp/util/index.html" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">package</span></span> <span class="symbol"><a href="util/index.html" title=""><span class="name">util</span></a></span></li><li class="current-entities indented1"><a href="BufferPair$.html" title="" class="object"></a> <a href="BufferPair.html" title="" class="class"></a><a href="BufferPair.html" title="">BufferPair</a></li><li class="current-entities indented1"><span class="separator"></span> <a href="CPU$.html" title="" class="object"></a><a href="CPU$.html" title="">CPU</a></li><li class="current-entities indented1"><span class="separator"></span> <a href="CudaDevice.html" title="" class="class"></a><a href="CudaDevice.html" title="">CudaDevice</a></li><li class="current-entities indented1"><a href="Device$.html" title="" class="object"></a> <a href="Device.html" title="Represents a device where tensors are stored and tensor operations are executed" class="trait"></a><a href="Device.html" title="Represents a device where tensors are stored and tensor operations are executed">Device</a></li><li class="current-entities indented1"><span class="separator"></span> <a href="DoublePrecision$.html" title="" class="object"></a><a href="DoublePrecision$.html" title="">DoublePrecision</a></li><li class="current-entities indented1"><a href="EmptyMovable$.html" title="" class="object"></a> <a href="EmptyMovable.html" title="" class="class"></a><a href="EmptyMovable.html" title="">EmptyMovable</a></li><li class="current-entities indented1"><span class="separator"></span> <a href="FloatingPointPrecision.html" title="" class="trait"></a><a href="FloatingPointPrecision.html" title="">FloatingPointPrecision</a></li><li class="current-entities indented1"><span class="separator"></span> <a href="HalfPrecision$.html" title="" class="object"></a><a href="HalfPrecision$.html" title="">HalfPrecision</a></li><li class="current-entities indented1"><a href="Movable$.html" title="" class="object"></a> <a href="Movable.html" title="" class="trait"></a><a href="Movable.html" title="">Movable</a></li><li class="current-entities indented1"><a href="NcclUniqueId$.html" title="" class="object"></a> <a href="NcclUniqueId.html" title="" class="class"></a><a href="NcclUniqueId.html" title="">NcclUniqueId</a></li><li class="current-entities indented1"><a href="STen$.html" title="Companion object of lamp.STen" class="object"></a> <a href="STen.html" title="Memory managed, off-heap, GPU and CPU compatible N-dimensional array." class="class"></a><a href="STen.html" title="Memory managed, off-heap, GPU and CPU compatible N-dimensional array.">STen</a></li><li class="current-entities indented1"><a href="STenOptions$.html" title="" class="object"></a> <a href="STenOptions.html" title="" class="class"></a><a href="STenOptions.html" title="">STenOptions</a></li><li class="current-entities indented1"><a href="Scope$.html" title="" class="object"></a> <a href="Scope.html" title="Faciliates memory management of off-heap data structures." class="class"></a><a href="Scope.html" title="Faciliates memory management of off-heap data structures.">Scope</a></li><li class="current-entities indented1"><span class="separator"></span> <a href="SinglePrecision$.html" title="" class="object"></a><a href="SinglePrecision$.html" title="">SinglePrecision</a></li><li class="current-entities indented1"><span class="separator"></span> <a href="TensorHelpers$.html" title="" class="object"></a><a href="TensorHelpers$.html" title="">TensorHelpers</a></li></ul></div></div><div id="content"><body class="package value"><div id="definition"><div class="big-circle package">p</div><h1>lamp<span class="permalink"><a href="../lamp/index.html" title="Permalink"><i class="material-icons"></i></a></span></h1></div><h4 id="signature" class="signature"><span class="modifier_kind"><span class="modifier"></span> <span class="kind">package</span></span> <span class="symbol"><span class="name">lamp</span></span></h4><div id="comment" class="fullcommenttop"><div class="comment cmt"><p>Lamp provides utilities to build state of the art machine learning
applications</p><h3>Overview</h3><p>Notable types and packages:</p><ul><li><a href="STen.html" name="lamp.STen" id="lamp.STen" class="extype">lamp.STen</a> is a memory managed wrapper around aten.ATen, an off the
    heap, native n-dimensionl array backed by libtorch.</li><li><a href="autograd/index.html" name="lamp.autograd" id="lamp.autograd" class="extype">lamp.autograd</a> implements reverse mode automatic differentiation.</li><li><a href="nn/index.html" name="lamp.nn" id="lamp.nn" class="extype">lamp.nn</a> contains neural network building blocks, see e.g.
    <a href="nn/Linear.html" name="lamp.nn.Linear" id="lamp.nn.Linear" class="extype">lamp.nn.Linear</a>.</li><li><a href="data/IOLoops$.html" name="lamp.data.IOLoops" id="lamp.data.IOLoops" class="extype">lamp.data.IOLoops</a> implements a training loop and other data related
    abstractions.</li><li><a href="knn/index.html" name="lamp.knn" id="lamp.knn" class="extype">lamp.knn</a> implements k-nearest neighbor search on the CPU and GPU</li><li><a href="umap/Umap$.html" name="lamp.umap.Umap" id="lamp.umap.Umap" class="extype">lamp.umap.Umap</a> implements the UMAP dimension reduction algorithm</li><li><a href="onnx/index.html" name="lamp.onnx" id="lamp.onnx" class="extype">lamp.onnx</a> implements serialization of computation graphs into ONNX
    format</li><li>lamp.io contains CSV and NPY readers</li></ul><h5>How to get data into lamp</h5><p>Use one of the file readers in lamp.io or one of the factories in
<a href="STen$.html" name="lamp.STen" id="lamp.STen" class="extype">lamp.STen$</a>.</p><h5>How to define a custom neural network layer</h5><p>See the documentation on <a href="nn/GenericModule.html" name="lamp.nn.GenericModule" id="lamp.nn.GenericModule" class="extype">lamp.nn.GenericModule</a></p><h5>How to compose neural network layers</h5><p>See the documentation on <a href="nn/index.html" name="lamp.nn" id="lamp.nn" class="extype">lamp.nn</a></p><h5>How to train models</h5><p>See the training loops in <a href="data/IOLoops$.html" name="lamp.data.IOLoops" id="lamp.data.IOLoops" class="extype">lamp.data.IOLoops</a>
</p></div><div class="toggleContainer"><div class="toggle block"><span>Linear Supertypes</span><div class="superTypes hiddenContent"><span name="scala.AnyRef" class="extype">AnyRef</span>, <span name="scala.Any" class="extype">Any</span></div></div></div></div><div id="mbrsel"><div class="toggle"></div><div id="memberfilter"><i class="material-icons arrow"></i><span class="input"><input placeholder="Filter all members" id="mbrsel-input" type="text" accesskey="/"/></span><i class="clear material-icons"></i></div><div id="filterby"><div id="order"><span class="filtertype">Ordering</span><ol><li class="alpha in"><span>Alphabetic</span></li><li class="inherit out"><span>By Inheritance</span></li></ol></div><div class="ancestors"><span class="filtertype">Inherited<br/></span><ol id="linearization"><li class="in" name="lamp"><span>lamp</span></li><li class="in" name="scala.AnyRef"><span>AnyRef</span></li><li class="in" name="scala.Any"><span>Any</span></li></ol></div><div class="ancestors"><span class="filtertype"></span><ol><li class="hideall out"><span>Hide All</span></li><li class="showall in"><span>Show All</span></li></ol></div><div id="visbl"><span class="filtertype">Visibility</span><ol><li class="public in"><span>Public</span></li><li class="protected out"><span>Protected</span></li></ol></div></div></div><div id="template"><div id="allMembers"><div id="packages" class="package members"><h3>Package Members</h3><ol><li class="indented0 " name="lamp.autograd" group="Ungrouped" fullComment="yes" data-isabs="false" visbl="pub"><a id="autograd" class="anchorToMember"></a><a id="autograd:autograd" class="anchorToMember"></a> <span class="permalink"><a href="../lamp/autograd/index.html" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">package</span></span> <span class="symbol"><a href="autograd/index.html" title="Implements reverse mode automatic differentiaton"><span class="name">autograd</span></a></span><p class="shortcomment cmt">Implements reverse mode automatic differentiaton</p><div class="fullcomment"><div class="comment cmt"><p>Implements reverse mode automatic differentiaton</p><p>The main types in this package are <a href="autograd/Variable.html" name="lamp.autograd.Variable" id="lamp.autograd.Variable" class="extype">lamp.autograd.Variable</a> and
<a href="autograd/Op.html" name="lamp.autograd.Op" id="lamp.autograd.Op" class="extype">lamp.autograd.Op</a>. The computational graph built by this package consists
of vertices representing values (as <a href="autograd/Variable.html" name="lamp.autograd.Variable" id="lamp.autograd.Variable" class="extype">lamp.autograd.Variable</a>) and vertices
representing operations (as <a href="autograd/Op.html" name="lamp.autograd.Op" id="lamp.autograd.Op" class="extype">lamp.autograd.Op</a>).</p><p>Variables contain the value of a <code>R<sup>n</sup> =&gt; R<sup>m</sup></code> function. Variables may also
contain the partial derivative of their argument with respect to a single
scalar. A Variable whose value is a scalar (m=1) can trigger the computation
of partial derivatives of all the intermediate upstream Variables. Computing
partial derivatives with respect to non-scalar variables is not supported.</p><p>A constant Variable may be created with the <code>const</code> or <code>param</code> factory
method in this package. <code>const</code> may be used for constants which do not need
their partial derivatives to be computed. <code>param</code> on the other hand create
Variables which will fill in their partial derivatives. Further variables
may be created by the methods in this class, eventually expressing more
complex <code>R<sup>n</sup> =&gt; R<sup>m</sup></code> functions.</p><h5>Example</h5><pre>lamp.Scope.root{ <span class="kw">implicit</span> scope <span class="kw">=&gt;</span>
  <span class="cmt">// x is constant (depends on no other variables) and won't compute a partial derivative</span>
  <span class="kw">val</span> x = lamp.autograd.const(STen.eye(<span class="num">3</span>, STenOptions.d))
  <span class="cmt">// y is constant but will compute a partial derivative</span>
  <span class="kw">val</span> y = lamp.autograd.param(STen.ones(<span class="std">List</span>(<span class="num">3</span>,<span class="num">3</span>), STenOptions.d))

  <span class="cmt">// z is a Variable with x and y dependencies</span>
  <span class="kw">val</span> z = x+y

  <span class="cmt">// w is a Variable with z as a direct and x, y as transient dependencies</span>
  <span class="kw">val</span> w = z.sum
  <span class="cmt">// w is a scalar (number of elements is 1), thus we can call backprop() on it.</span>
  <span class="cmt">// calling backprop will fill out the partial derivatives of the upstream variables</span>
  w.backprop()

  <span class="cmt">// partialDerivative is empty since we created `x` with `const`</span>
  assert(x.partialDerivative.isEmpty)

  <span class="cmt">// `y`'s partial derivatie is defined and is computed</span>
  <span class="cmt">// it holds `y`'s partial derivative with respect to `w`, the scalar which we called backprop() on</span>
  assert(y.partialDerivative.isDefined)

}</pre><p>This package may be used to compute the derivative of any function, provided
the function can be composed out of the provided methods. A particular use
case is gradient based optimization.
</p></div><dl class="attributes block"><dt>See also</dt><dd><span class="cmt"><p>
  <a href="https://arxiv.org/pdf/1811.05031.pdf" target="_blank">https://arxiv.org/pdf/1811.05031.pdf</a> for a review of the algorithm</p></span><span class="cmt"><p>
  <a href="autograd/Op.html" name="lamp.autograd.Op" id="lamp.autograd.Op" class="extype">lamp.autograd.Op</a> for how to implement a new operation</p></span></dd></dl></div></li><li class="indented0 " name="lamp.data" group="Ungrouped" fullComment="no" data-isabs="false" visbl="pub"><a id="data" class="anchorToMember"></a><a id="data:data" class="anchorToMember"></a> <span class="permalink"><a href="../lamp/data/index.html" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">package</span></span> <span class="symbol"><a href="data/index.html" title=""><span class="name">data</span></a></span></li><li class="indented0 " name="lamp.distributed" group="Ungrouped" fullComment="no" data-isabs="false" visbl="pub"><a id="distributed" class="anchorToMember"></a><a id="distributed:distributed" class="anchorToMember"></a> <span class="permalink"><a href="../lamp/distributed/index.html" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">package</span></span> <span class="symbol"><a href="distributed/index.html" title=""><span class="name">distributed</span></a></span></li><li class="indented0 " name="lamp.extratrees" group="Ungrouped" fullComment="no" data-isabs="false" visbl="pub"><a id="extratrees" class="anchorToMember"></a><a id="extratrees:extratrees" class="anchorToMember"></a> <span class="permalink"><a href="../lamp/extratrees/index.html" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">package</span></span> <span class="symbol"><a href="extratrees/index.html" title=""><span class="name">extratrees</span></a></span></li><li class="indented0 " name="lamp.knn" group="Ungrouped" fullComment="no" data-isabs="false" visbl="pub"><a id="knn" class="anchorToMember"></a><a id="knn:knn" class="anchorToMember"></a> <span class="permalink"><a href="../lamp/knn/index.html" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">package</span></span> <span class="symbol"><a href="knn/index.html" title=""><span class="name">knn</span></a></span></li><li class="indented0 " name="lamp.nn" group="Ungrouped" fullComment="yes" data-isabs="false" visbl="pub"><a id="nn" class="anchorToMember"></a><a id="nn:nn" class="anchorToMember"></a> <span class="permalink"><a href="../lamp/nn/index.html" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">package</span></span> <span class="symbol"><a href="nn/index.html" title="Provides building blocks for neural networks"><span class="name">nn</span></a></span><p class="shortcomment cmt">Provides building blocks for neural networks</p><div class="fullcomment"><div class="comment cmt"><p>Provides building blocks for neural networks</p><p>Notable types:</p><ul><li><a href="nn/GenericModule.html" name="lamp.nn.GenericModule" id="lamp.nn.GenericModule" class="extype">nn.GenericModule</a> is an abstraction on parametric functions</li><li><a href="nn/Optimizer.html" name="lamp.nn.Optimizer" id="lamp.nn.Optimizer" class="extype">nn.Optimizer</a> is an abstraction of gradient based optimizers</li><li><a href="nn/LossFunction.html" name="lamp.nn.LossFunction" id="lamp.nn.LossFunction" class="extype">nn.LossFunction</a> is an abstraction of loss functions, see the
    companion object for the implemented losses</li><li><a href="nn/SupervisedModel.html" name="lamp.nn.SupervisedModel" id="lamp.nn.SupervisedModel" class="extype">nn.SupervisedModel</a> combines a module with a loss</li></ul><p>Optimizers:</p><ul><li><a href="nn/AdamW.html" name="lamp.nn.AdamW" id="lamp.nn.AdamW" class="extype">nn.AdamW</a></li><li><a href="nn/SGDW.html" name="lamp.nn.SGDW" id="lamp.nn.SGDW" class="extype">nn.SGDW</a></li><li><a href="nn/RAdam.html" name="lamp.nn.RAdam" id="lamp.nn.RAdam" class="extype">nn.RAdam</a></li><li><a href="nn/Yogi.html" name="lamp.nn.Yogi" id="lamp.nn.Yogi" class="extype">nn.Yogi</a></li></ul><p>Modules facilitating composing other modules:</p><ul><li><a href="nn/Sequential.html" name="lamp.nn.Sequential" id="lamp.nn.Sequential" class="extype">nn.Sequential</a> composes a homogenous list of modules (analogous to
    List)</li><li><a href="nn/sequence$.html" name="lamp.nn.sequence" id="lamp.nn.sequence" class="extype">nn.sequence</a> composes a heterogeneous list of modules (analogous to
    tuples)</li><li><a href="nn/EitherModule.html" name="lamp.nn.EitherModule" id="lamp.nn.EitherModule" class="extype">nn.EitherModule</a> composes two modules in a scala.Either</li></ul><p>Examples of neural network building blocks, layers etc:</p><ul><li><a href="nn/Linear.html" name="lamp.nn.Linear" id="lamp.nn.Linear" class="extype">nn.Linear</a> implements <code>W X + b</code> with parameters <code>W</code> and <code>b</code> and input
    <code>X</code></li><li><a href="nn/BatchNorm.html" name="lamp.nn.BatchNorm" id="lamp.nn.BatchNorm" class="extype">nn.BatchNorm</a>, <a href="nn/LayerNorm.html" name="lamp.nn.LayerNorm" id="lamp.nn.LayerNorm" class="extype">nn.LayerNorm</a> implement batch and layer
    normalization</li><li><a href="nn/MLP$.html" name="lamp.nn.MLP" id="lamp.nn.MLP" class="extype">nn.MLP</a> is a factory of a multilayer perceptron architecture
</li></ul></div></div></li><li class="indented0 " name="lamp.onnx" group="Ungrouped" fullComment="no" data-isabs="false" visbl="pub"><a id="onnx" class="anchorToMember"></a><a id="onnx:onnx" class="anchorToMember"></a> <span class="permalink"><a href="../lamp/onnx/index.html" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">package</span></span> <span class="symbol"><a href="onnx/index.html" title=""><span class="name">onnx</span></a></span></li><li class="indented0 " name="lamp.saddle" group="Ungrouped" fullComment="no" data-isabs="false" visbl="pub"><a id="saddle" class="anchorToMember"></a><a id="saddle:saddle" class="anchorToMember"></a> <span class="permalink"><a href="../lamp/saddle/index.html" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">package</span></span> <span class="symbol"><a href="saddle/index.html" title=""><span class="name">saddle</span></a></span></li><li class="indented0 " name="lamp.umap" group="Ungrouped" fullComment="no" data-isabs="false" visbl="pub"><a id="umap" class="anchorToMember"></a><a id="umap:umap" class="anchorToMember"></a> <span class="permalink"><a href="../lamp/umap/index.html" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">package</span></span> <span class="symbol"><a href="umap/index.html" title=""><span class="name">umap</span></a></span></li><li class="indented0 " name="lamp.util" group="Ungrouped" fullComment="no" data-isabs="false" visbl="pub"><a id="util" class="anchorToMember"></a><a id="util:util" class="anchorToMember"></a> <span class="permalink"><a href="../lamp/util/index.html" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">package</span></span> <span class="symbol"><a href="util/index.html" title=""><span class="name">util</span></a></span></li></ol></div><div id="types" class="types members"><h3>Type Members</h3><ol><li class="indented0 " name="lamp.BufferPair" group="Ungrouped" fullComment="no" data-isabs="false" visbl="pub"><a id="BufferPairextendsProductwithSerializable" class="anchorToMember"></a><a id="BufferPair:BufferPair" class="anchorToMember"></a> <span class="permalink"><a href="../lamp/BufferPair.html" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">case class</span></span> <span class="symbol"><a href="BufferPair.html" title=""><span class="name">BufferPair</span></a><span class="params">(<span name="source">source: <a href="STen.html" name="lamp.STen" id="lamp.STen" class="extype">STen</a></span>, <span name="destination">destination: <a href="STen.html" name="lamp.STen" id="lamp.STen" class="extype">STen</a></span>)</span><span class="result"> extends <span name="scala.Product" class="extype">Product</span> with <span name="scala.Serializable" class="extype">Serializable</span></span></span></li><li class="indented0 " name="lamp.CudaDevice" group="Ungrouped" fullComment="no" data-isabs="false" visbl="pub"><a id="CudaDeviceextendsDevicewithProductwithSerializable" class="anchorToMember"></a><a id="CudaDevice:CudaDevice" class="anchorToMember"></a> <span class="permalink"><a href="../lamp/CudaDevice.html" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">case class</span></span> <span class="symbol"><a href="CudaDevice.html" title=""><span class="name">CudaDevice</span></a><span class="params">(<span name="i">i: <span name="scala.Int" class="extype">Int</span></span>)</span><span class="result"> extends <a href="Device.html" name="lamp.Device" id="lamp.Device" class="extype">Device</a> with <span name="scala.Product" class="extype">Product</span> with <span name="scala.Serializable" class="extype">Serializable</span></span></span></li><li class="indented0 " name="lamp.Device" group="Ungrouped" fullComment="no" data-isabs="true" visbl="pub"><a id="DeviceextendsAnyRef" class="anchorToMember"></a><a id="Device:Device" class="anchorToMember"></a> <span class="permalink"><a href="../lamp/Device.html" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier">sealed </span> <span class="kind">trait</span></span> <span class="symbol"><a href="Device.html" title="Represents a device where tensors are stored and tensor operations are executed"><span class="name">Device</span></a><span class="result"> extends <span name="scala.AnyRef" class="extype">AnyRef</span></span></span><p class="shortcomment cmt">Represents a device where tensors are stored and tensor operations are
executed
</p></li><li class="indented0 " name="lamp.EmptyMovable" group="Ungrouped" fullComment="no" data-isabs="false" visbl="pub"><a id="EmptyMovable[-R]extendsAnyRef" class="anchorToMember"></a><a id="EmptyMovable[-R]:EmptyMovable[R]" class="anchorToMember"></a> <span class="permalink"><a href="../lamp/EmptyMovable.html" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">class</span></span> <span class="symbol"><a href="EmptyMovable.html" title=""><span class="name">EmptyMovable</span></a><span class="tparams">[<span name="R">-R</span>]</span><span class="result"> extends <span name="scala.AnyRef" class="extype">AnyRef</span></span></span></li><li class="indented0 " name="lamp.FloatingPointPrecision" group="Ungrouped" fullComment="no" data-isabs="true" visbl="pub"><a id="FloatingPointPrecisionextendsAnyRef" class="anchorToMember"></a><a id="FloatingPointPrecision:FloatingPointPrecision" class="anchorToMember"></a> <span class="permalink"><a href="../lamp/FloatingPointPrecision.html" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier">sealed </span> <span class="kind">trait</span></span> <span class="symbol"><a href="FloatingPointPrecision.html" title=""><span class="name">FloatingPointPrecision</span></a><span class="result"> extends <span name="scala.AnyRef" class="extype">AnyRef</span></span></span></li><li class="indented0 " name="lamp.Movable" group="Ungrouped" fullComment="no" data-isabs="true" visbl="pub"><a id="Movable[-R]extendsAnyRef" class="anchorToMember"></a><a id="Movable[-R]:Movable[R]" class="anchorToMember"></a> <span class="permalink"><a href="../lamp/Movable.html" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">trait</span></span> <span class="symbol"><a href="Movable.html" title=""><span class="name">Movable</span></a><span class="tparams">[<span name="R">-R</span>]</span><span class="result"> extends <span name="scala.AnyRef" class="extype">AnyRef</span></span></span></li><li class="indented0 " name="lamp.NcclUniqueId" group="Ungrouped" fullComment="no" data-isabs="false" visbl="pub"><a id="NcclUniqueIdextendsProductwithSerializable" class="anchorToMember"></a><a id="NcclUniqueId:NcclUniqueId" class="anchorToMember"></a> <span class="permalink"><a href="../lamp/NcclUniqueId.html" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">case class</span></span> <span class="symbol"><a href="NcclUniqueId.html" title=""><span class="name">NcclUniqueId</span></a><span class="params">(<span name="base64">base64: <span name="scala.Predef.String" class="extype">String</span></span>)</span><span class="result"> extends <span name="scala.Product" class="extype">Product</span> with <span name="scala.Serializable" class="extype">Serializable</span></span></span></li><li class="indented0 " name="lamp.STen" group="Ungrouped" fullComment="yes" data-isabs="false" visbl="pub"><a id="STenextendsProductwithSerializable" class="anchorToMember"></a><a id="STen:STen" class="anchorToMember"></a> <span class="permalink"><a href="../lamp/STen.html" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">case class</span></span> <span class="symbol"><a href="STen.html" title="Memory managed, off-heap, GPU and CPU compatible N-dimensional array."><span class="name">STen</span></a><span class="result"> extends <span name="scala.Product" class="extype">Product</span> with <span name="scala.Serializable" class="extype">Serializable</span></span></span><p class="shortcomment cmt">Memory managed, off-heap, GPU and CPU compatible N-dimensional array.</p><div class="fullcomment"><div class="comment cmt"><p>Memory managed, off-heap, GPU and CPU compatible N-dimensional array.</p><p>This class is a wrapper around aten.Tensor providing a more convenient API.
All allocating operations require an implicit <a href="Scope.html" name="lamp.Scope" id="lamp.Scope" class="extype">lamp.Scope</a>.</p><p>STen instances are associated with a device which determines where the
memory is allocated, and where the operations are performed. Operations on
multiple tensors expect that all the arguments reside on the same device.</p><p><a href="STen.html#options[S](implicitevidence$49:lamp.Sc[S]):lamp.STenOptions" name="lamp.STen#options" id="lamp.STen#options" class="extmbr">lamp.STen.options</a> returns a <a href="STenOptions.html" name="lamp.STenOptions" id="lamp.STenOptions" class="extype">lamp.STenOptions</a> which describes the
device, shape, data type and storage layout of a tensor. Most factory
methods in the companion object in turn require a <a href="STenOptions.html" name="lamp.STenOptions" id="lamp.STenOptions" class="extype">lamp.STenOptions</a> to
specify the device, data types and storage layout.</p><p>Naming convention of most operations follows libtorch. Operations return
their result in a copy, i.e. not in place. These operations need a
<a href="Scope.html" name="lamp.Scope" id="lamp.Scope" class="extype">lamp.Scope</a>. Operations whose name ends with an underscore are in place.
Operations whose name contains <code>out</code> will write their results into the
specified output tensor, these are in the companion object. Some operations
are exempt from this naming rule, e.g. <code>+=</code>, <code>-=</code>, <code>*=</code> etc.</p><p>Semantics of operations follow those of libtorch with the same name. Many of
the operations broadcasts. See
<a href="https://numpy.org/doc/stable/user/basics.broadcasting.html#general-broadcasting-rules" target="_blank">https://numpy.org/doc/stable/user/basics.broadcasting.html#general-broadcasting-rules</a>
for broadcasting rules. In short:</p><ol class="decimal"><li>shapes are aligned from the right, extending with ones to the left as
     needed. 2. If two aligned dimensions are not matching but one of them
     is 1, then it is expanded to the size of the other dimension,
     pretending a copy of all its values. If two aligned dimension are not
     matching and neither of them is 1, then the operation fails.</li></ol><h3>Examples</h3><pre>Scope.root { <span class="kw">implicit</span> scope <span class="kw">=&gt;</span>
    <span class="kw">val</span> sum = Scope { <span class="kw">implicit</span> scope <span class="kw">=&gt;</span>
    <span class="kw">val</span> ident = STen.eye(<span class="num">3</span>, STenOptions.d)
    <span class="kw">val</span> ones = STen.ones(<span class="std">List</span>(<span class="num">3</span>, <span class="num">3</span>), STenOptions.d)
    ident + ones
    }
    assert(sum.toMat == mat.ones(<span class="num">3</span>, <span class="num">3</span>) + mat.ident(<span class="num">3</span>))
}</pre><h5>Broadcasting examples</h5><pre><span class="cmt">// successful</span>
<span class="num">3</span> x <span class="num">4</span> x <span class="num">6</span> A
    <span class="num">4</span> x <span class="num">6</span> B
<span class="num">3</span> x <span class="num">4</span> x <span class="num">6</span> Result <span class="cmt">// B is repeated 3 times first dimensions</span>

<span class="cmt">// successful</span>
<span class="num">3</span> x <span class="num">4</span> x <span class="num">6</span> A
<span class="num">3</span> x <span class="num">1</span> x <span class="num">6</span> B
<span class="num">3</span> x <span class="num">4</span> x <span class="num">6</span> Result <span class="cmt">// B's second dimension is repeated 4 times</span>

<span class="cmt">// fail</span>
<span class="num">3</span> x <span class="num">4</span> x <span class="num">6</span> A
<span class="num">3</span> x <span class="num">2</span> x <span class="num">6</span> B
<span class="num">3</span> x <span class="num">4</span> x <span class="num">6</span> Result <span class="cmt">// 2 != 4</span></pre><p>The companion object contains various factories which copy data from the JVM
memory to STen tensors.
</p></div></div></li><li class="indented0 " name="lamp.STenOptions" group="Ungrouped" fullComment="no" data-isabs="false" visbl="pub"><a id="STenOptionsextendsProductwithSerializable" class="anchorToMember"></a><a id="STenOptions:STenOptions" class="anchorToMember"></a> <span class="permalink"><a href="../lamp/STenOptions.html" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">case class</span></span> <span class="symbol"><a href="STenOptions.html" title=""><span class="name">STenOptions</span></a><span class="params">(<span name="value">value: <span name="aten.TensorOptions" class="extype">TensorOptions</span></span>)</span><span class="result"> extends <span name="scala.Product" class="extype">Product</span> with <span name="scala.Serializable" class="extype">Serializable</span></span></span></li><li class="indented0 " name="lamp.Sc" group="Ungrouped" fullComment="no" data-isabs="false" visbl="pub"><a id="Sc[_]=lamp.Scope" class="anchorToMember"></a><a id="Sc[_]:Sc[_]" class="anchorToMember"></a> <span class="permalink"><a href="../lamp/index.html#Sc[_]=lamp.Scope" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">type</span></span> <span class="symbol"><span class="name">Sc</span><span class="tparams">[<span name="_">_</span>]</span><span class="result alias"> = <a href="Scope.html" name="lamp.Scope" id="lamp.Scope" class="extype">Scope</a></span></span></li><li class="indented0 " name="lamp.Scope" group="Ungrouped" fullComment="yes" data-isabs="false" visbl="pub"><a id="ScopeextendsAnyRef" class="anchorToMember"></a><a id="Scope:Scope" class="anchorToMember"></a> <span class="permalink"><a href="../lamp/Scope.html" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier">final </span> <span class="kind">class</span></span> <span class="symbol"><a href="Scope.html" title="Faciliates memory management of off-heap data structures."><span class="name">Scope</span></a><span class="result"> extends <span name="scala.AnyRef" class="extype">AnyRef</span></span></span><p class="shortcomment cmt">Faciliates memory management of off-heap data structures.</p><div class="fullcomment"><div class="comment cmt"><p>Faciliates memory management of off-heap data structures.</p><p>Tracks allocations of aten.Tensor and aten.TensorOption instances.</p><p>aten.Tensor and aten.TensorOption instances are not freed up by the garbage
collector. Lamp implements zoned memory management around these object. The
managed counterpart of aten.Tensor is <a href="STen.html" name="lamp.STen" id="lamp.STen" class="extype">lamp.STen</a>, while for
aten.TensorOption it is <a href="STenOptions.html" name="lamp.STenOptions" id="lamp.STenOptions" class="extype">lamp.STenOptions</a>.</p><p>One can only create a <a href="STen.html" name="lamp.STen" id="lamp.STen" class="extype">lamp.STen</a> instance with a <a href="Scope.html" name="lamp.Scope" id="lamp.Scope" class="extype">lamp.Scope</a> in
implicit scope.</p><p>Create new scopes with <a href="Scope$.html#root[A](op:lamp.Scope=&gt;A)(implicitevidence$55:lamp.EmptyMovable[A]):A" name="lamp.Scope#root" id="lamp.Scope#root" class="extmbr">lamp.Scope.root</a>, <a href="Scope$.html#apply[A](op:lamp.Scope=&gt;A)(implicitevidence$54:lamp.Movable[A],implicitparent:lamp.Scope):A" name="lamp.Scope#apply" id="lamp.Scope#apply" class="extmbr">lamp.Scope.apply</a> or
<a href="Scope$.html#root[A](op:lamp.Scope=&gt;A)(implicitevidence$55:lamp.EmptyMovable[A]):A" name="lamp.Scope#root" id="lamp.Scope#root" class="extmbr">lamp.Scope.root</a>.</p><h3>Examples</h3><pre><span class="cmt">// Scope.root returns Unit</span>
Scope.root { <span class="kw">implicit</span> scope <span class="kw">=&gt;</span>
    <span class="kw">val</span> sum = Scope { <span class="kw">implicit</span> scope <span class="kw">=&gt;</span>
    <span class="cmt">// Intermediate values allocated in this block (`ident` and `ones`) are freed when</span>
    <span class="cmt">// this block returns</span>
    <span class="cmt">// The return value (`ident + ones`) of this block is moved to the outer scope</span>
    <span class="kw">val</span> ident = STen.eye(<span class="num">3</span>, STenOptions.d)
    <span class="kw">val</span> ones = STen.ones(<span class="std">List</span>(<span class="num">3</span>, <span class="num">3</span>), STenOptions.d)
    ident + ones
    }
    assert(sum.toMat == mat.ones(<span class="num">3</span>, <span class="num">3</span>) + mat.ident(<span class="num">3</span>))
    <span class="cmt">// `sum` is freed once this block exits</span>
}</pre></div></div></li></ol></div><div class="values members"><h3>Value Members</h3><ol><li class="indented0 " name="lamp#scope" group="Ungrouped" fullComment="no" data-isabs="false" visbl="pub"><a id="scope(implicits:lamp.Scope):lamp.Scope" class="anchorToMember"></a><a id="scope(Scope):Scope" class="anchorToMember"></a> <span class="permalink"><a href="../lamp/index.html#scope(implicits:lamp.Scope):lamp.Scope" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">def</span></span> <span class="symbol"><span class="name">scope</span><span class="params">(<span class="implicit">implicit </span><span name="s">s: <a href="Scope.html" name="lamp.Scope" id="lamp.Scope" class="extype">Scope</a></span>)</span><span class="result">: <a href="Scope.html" name="lamp.Scope" id="lamp.Scope" class="extype">Scope</a></span></span></li><li class="indented0 " name="lamp#scoped" group="Ungrouped" fullComment="no" data-isabs="false" visbl="pub"><a id="scoped(r:aten.Tensor)(implicits:lamp.Scope):aten.Tensor" class="anchorToMember"></a><a id="scoped(Tensor)(Scope):Tensor" class="anchorToMember"></a> <span class="permalink"><a href="../lamp/index.html#scoped(r:aten.Tensor)(implicits:lamp.Scope):aten.Tensor" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">def</span></span> <span class="symbol"><span class="name">scoped</span><span class="params">(<span name="r">r: <span name="aten.Tensor" class="extype">Tensor</span></span>)</span><span class="params">(<span class="implicit">implicit </span><span name="s">s: <a href="Scope.html" name="lamp.Scope" id="lamp.Scope" class="extype">Scope</a></span>)</span><span class="result">: <span name="aten.Tensor" class="extype">Tensor</span></span></span></li><li class="indented0 " name="lamp.BufferPair" group="Ungrouped" fullComment="no" data-isabs="false" visbl="pub"><a id="BufferPair" class="anchorToMember"></a><a id="BufferPair:BufferPair" class="anchorToMember"></a> <span class="permalink"><a href="../lamp/BufferPair$.html" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">object</span></span> <span class="symbol"><a href="BufferPair$.html" title=""><span class="name">BufferPair</span></a><span class="result"> extends <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/Serializable.html#java.io.Serializable" name="java.io.Serializable" id="java.io.Serializable" class="extype">Serializable</a></span></span></li><li class="indented0 " name="lamp.CPU" group="Ungrouped" fullComment="no" data-isabs="false" visbl="pub"><a id="CPU" class="anchorToMember"></a><a id="CPU:CPU" class="anchorToMember"></a> <span class="permalink"><a href="../lamp/CPU$.html" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">case object</span></span> <span class="symbol"><a href="CPU$.html" title=""><span class="name">CPU</span></a><span class="result"> extends <a href="Device.html" name="lamp.Device" id="lamp.Device" class="extype">Device</a> with <span name="scala.Product" class="extype">Product</span> with <span name="scala.Serializable" class="extype">Serializable</span></span></span></li><li class="indented0 " name="lamp.Device" group="Ungrouped" fullComment="no" data-isabs="false" visbl="pub"><a id="Device" class="anchorToMember"></a><a id="Device:Device" class="anchorToMember"></a> <span class="permalink"><a href="../lamp/Device$.html" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">object</span></span> <span class="symbol"><a href="Device$.html" title=""><span class="name">Device</span></a></span></li><li class="indented0 " name="lamp.DoublePrecision" group="Ungrouped" fullComment="no" data-isabs="false" visbl="pub"><a id="DoublePrecision" class="anchorToMember"></a><a id="DoublePrecision:DoublePrecision" class="anchorToMember"></a> <span class="permalink"><a href="../lamp/DoublePrecision$.html" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">case object</span></span> <span class="symbol"><a href="DoublePrecision$.html" title=""><span class="name">DoublePrecision</span></a><span class="result"> extends <a href="FloatingPointPrecision.html" name="lamp.FloatingPointPrecision" id="lamp.FloatingPointPrecision" class="extype">FloatingPointPrecision</a> with <span name="scala.Product" class="extype">Product</span> with <span name="scala.Serializable" class="extype">Serializable</span></span></span></li><li class="indented0 " name="lamp.EmptyMovable" group="Ungrouped" fullComment="no" data-isabs="false" visbl="pub"><a id="EmptyMovable" class="anchorToMember"></a><a id="EmptyMovable:EmptyMovable" class="anchorToMember"></a> <span class="permalink"><a href="../lamp/EmptyMovable$.html" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">object</span></span> <span class="symbol"><a href="EmptyMovable$.html" title=""><span class="name">EmptyMovable</span></a></span></li><li class="indented0 " name="lamp.HalfPrecision" group="Ungrouped" fullComment="no" data-isabs="false" visbl="pub"><a id="HalfPrecision" class="anchorToMember"></a><a id="HalfPrecision:HalfPrecision" class="anchorToMember"></a> <span class="permalink"><a href="../lamp/HalfPrecision$.html" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">case object</span></span> <span class="symbol"><a href="HalfPrecision$.html" title=""><span class="name">HalfPrecision</span></a><span class="result"> extends <a href="FloatingPointPrecision.html" name="lamp.FloatingPointPrecision" id="lamp.FloatingPointPrecision" class="extype">FloatingPointPrecision</a> with <span name="scala.Product" class="extype">Product</span> with <span name="scala.Serializable" class="extype">Serializable</span></span></span></li><li class="indented0 " name="lamp.Movable" group="Ungrouped" fullComment="no" data-isabs="false" visbl="pub"><a id="Movable" class="anchorToMember"></a><a id="Movable:Movable" class="anchorToMember"></a> <span class="permalink"><a href="../lamp/Movable$.html" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">object</span></span> <span class="symbol"><a href="Movable$.html" title=""><span class="name">Movable</span></a></span></li><li class="indented0 " name="lamp.NcclUniqueId" group="Ungrouped" fullComment="no" data-isabs="false" visbl="pub"><a id="NcclUniqueId" class="anchorToMember"></a><a id="NcclUniqueId:NcclUniqueId" class="anchorToMember"></a> <span class="permalink"><a href="../lamp/NcclUniqueId$.html" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">object</span></span> <span class="symbol"><a href="NcclUniqueId$.html" title=""><span class="name">NcclUniqueId</span></a><span class="result"> extends <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/Serializable.html#java.io.Serializable" name="java.io.Serializable" id="java.io.Serializable" class="extype">Serializable</a></span></span></li><li class="indented0 " name="lamp.STen" group="Ungrouped" fullComment="yes" data-isabs="false" visbl="pub"><a id="STen" class="anchorToMember"></a><a id="STen:STen" class="anchorToMember"></a> <span class="permalink"><a href="../lamp/STen$.html" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">object</span></span> <span class="symbol"><a href="STen$.html" title="Companion object of lamp.STen"><span class="name">STen</span></a><span class="result"> extends <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/Serializable.html#java.io.Serializable" name="java.io.Serializable" id="java.io.Serializable" class="extype">Serializable</a></span></span><p class="shortcomment cmt">Companion object of <a href="STen.html" name="lamp.STen" id="lamp.STen" class="extype">lamp.STen</a></p><div class="fullcomment"><div class="comment cmt"><p>Companion object of <a href="STen.html" name="lamp.STen" id="lamp.STen" class="extype">lamp.STen</a></p><ul><li><a href="STen$.html#fromDoubleArray[S](ar:Array[Double],dim:Seq[Long],device:lamp.Device,precision:lamp.FloatingPointPrecision)(implicitevidence$4:lamp.Sc[S]):lamp.STen" name="lamp.STen#fromDoubleArray" id="lamp.STen#fromDoubleArray" class="extmbr">STen.fromDoubleArray</a>, <a href="STen$.html#fromLongArray[S](ar:Array[Long])(implicitevidence$3:lamp.Sc[S]):lamp.STen" name="lamp.STen#fromLongArray" id="lamp.STen#fromLongArray" class="extmbr">STen.fromLongArray</a>,
    <a href="STen$.html#fromFloatArray[S](ar:Array[Float],dim:Seq[Long],device:lamp.Device)(implicitevidence$5:lamp.Sc[S]):lamp.STen" name="lamp.STen#fromFloatArray" id="lamp.STen#fromFloatArray" class="extmbr">STen.fromFloatArray</a> factory methods copy data from JVM arrays into
    off heap memory and create an STen instance</li><li>There are similar factories which take SADDLE data structures
</li></ul></div></div></li><li class="indented0 " name="lamp.STenOptions" group="Ungrouped" fullComment="no" data-isabs="false" visbl="pub"><a id="STenOptions" class="anchorToMember"></a><a id="STenOptions:STenOptions" class="anchorToMember"></a> <span class="permalink"><a href="../lamp/STenOptions$.html" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">object</span></span> <span class="symbol"><a href="STenOptions$.html" title=""><span class="name">STenOptions</span></a><span class="result"> extends <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/Serializable.html#java.io.Serializable" name="java.io.Serializable" id="java.io.Serializable" class="extype">Serializable</a></span></span></li><li class="indented0 " name="lamp.Scope" group="Ungrouped" fullComment="no" data-isabs="false" visbl="pub"><a id="Scope" class="anchorToMember"></a><a id="Scope:Scope" class="anchorToMember"></a> <span class="permalink"><a href="../lamp/Scope$.html" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">object</span></span> <span class="symbol"><a href="Scope$.html" title=""><span class="name">Scope</span></a></span></li><li class="indented0 " name="lamp.SinglePrecision" group="Ungrouped" fullComment="no" data-isabs="false" visbl="pub"><a id="SinglePrecision" class="anchorToMember"></a><a id="SinglePrecision:SinglePrecision" class="anchorToMember"></a> <span class="permalink"><a href="../lamp/SinglePrecision$.html" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">case object</span></span> <span class="symbol"><a href="SinglePrecision$.html" title=""><span class="name">SinglePrecision</span></a><span class="result"> extends <a href="FloatingPointPrecision.html" name="lamp.FloatingPointPrecision" id="lamp.FloatingPointPrecision" class="extype">FloatingPointPrecision</a> with <span name="scala.Product" class="extype">Product</span> with <span name="scala.Serializable" class="extype">Serializable</span></span></span></li><li class="indented0 " name="lamp.TensorHelpers" group="Ungrouped" fullComment="no" data-isabs="false" visbl="pub"><a id="TensorHelpers" class="anchorToMember"></a><a id="TensorHelpers:TensorHelpers" class="anchorToMember"></a> <span class="permalink"><a href="../lamp/TensorHelpers$.html" title="Permalink"><i class="material-icons"></i></a></span> <span class="modifier_kind"><span class="modifier"></span> <span class="kind">object</span></span> <span class="symbol"><a href="TensorHelpers$.html" title=""><span class="name">TensorHelpers</span></a></span></li></ol></div></div><div id="inheritedMembers"><div name="scala.AnyRef" class="parent"><h3>Inherited from <span name="scala.AnyRef" class="extype">AnyRef</span></h3></div><div name="scala.Any" class="parent"><h3>Inherited from <span name="scala.Any" class="extype">Any</span></h3></div></div><div id="groupedMembers"><div name="Ungrouped" class="group"><h3>Ungrouped</h3></div></div></div><div id="tooltip"></div><div id="footer"></div></body></div></div></div></body></html>
